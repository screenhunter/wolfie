{"version":3,"sources":["/home/havvy/tennu/tennu/src/test/plugin-help.sjs"],"names":["sinon","require","assert","equal","inspect","format","install","debug","logfn","console","log","bind","HelpPlugin","pluginHelps","a","b","b1","b2","b3","c","c1","d","e","f","client","config","value","Error","describe","instance","help","HELP_NOT_FOUND","beforeEach","init","exports","hooks","it"],"mappings":"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","file":"plugin-help.js","sourcesContent":["const sinon = require(\"sinon\");\nconst assert = require(\"better-assert\");\nconst equal = require(\"deep-eql\");\nconst inspect = require(\"util\").inspect;\nconst format = require(\"util\").format;\nrequire(\"source-map-support\").install();\n\nconst debug = false;\nconst logfn = debug ? console.log.bind(console) : function () {};\n\nconst HelpPlugin = require(\"../tennu_plugins/help\");\n\nconst pluginHelps = {\n    a: \"a *\",\n    b: {\n        b: {\n            \"*\": \"b *\",\n            b1: \"b 1\",\n            b2: [\"b 2_1\", \"b 2_2\"],\n            b3: {\n                \"*\": \"b 3 *\"\n            },\n        },\n    },\n    c: {\n        c1: \"c 1\"\n    },\n    d: [\"d *_1\", \"d *_2\"],\n    e: \"{{!}}e\",\n    f: [\"{{!}}\", \"{{!}}\"]\n};\n\nconst client = {\n    config: function (value) {\n        if (value === \"disable-help\") {\n            return false;\n        }\n\n        if (value === \"command-trigger\") {\n            return \"@\";\n        }\n\n        throw new Error(format(\"Error in testing: Plugin expects config value (%s) we don't have.\", value));\n    }\n};\n\ndescribe \"Help plugin\" {\n    var instance, help, HELP_NOT_FOUND;\n\n    beforeEach {\n        logfn(/* newline */);\n\n        instance = HelpPlugin.init(client, {});\n        HELP_NOT_FOUND = instance.exports.HELP_NOT_FOUND;\n\n        instance.hooks.help(\"a\", pluginHelps.a);\n        instance.hooks.help(\"b\", pluginHelps.b);\n        instance.hooks.help(\"c\", pluginHelps.c);\n        instance.hooks.help(\"d\", pluginHelps.d);\n        instance.hooks.help(\"e\", pluginHelps.e);\n        instance.hooks.help(\"f\", pluginHelps.f);\n\n        help = instance.exports.help;\n    }\n\n    it \"returns HELP_NOT_FOUND for unknown topics\" {\n        assert(help([\"dnd\"]) === HELP_NOT_FOUND);\n    }\n\n    it \"returns HELP_NOT_FOUND for subtopics of unknown topics\" {\n        assert(help([\"dne\", \"subtopic\"]) === HELP_NOT_FOUND);\n    }\n\n    it \"assigns the topic of the plugin name the value of the string when given a string\" {\n        logfn(inspect(help([\"a\"])));\n        assert(help([\"a\"]) === \"a *\");\n    }\n\n    it \"assigns the topic of the plugin name the value of the array when given an array\" {\n        logfn(inspect(help([\"d\"])));\n        assert(equal(help([\"d\"]), [\"d *_1\", \"d *_2\"]));\n    }\n\n    it \"gives the * property of topics with an object value\" {\n        assert(help([\"b\"]) === \"b *\");\n    }\n\n    it \"gives HELP_NOT_FOUND for topics with an object value without the * property\" {\n        assert(help([\"c\"]) === HELP_NOT_FOUND);\n    }\n\n    it \"gives the subtopic string value for subtopic type of string\" {\n        logfn(inspect(help([\"b\", \"b1\"])));\n        assert(help([\"b\", \"b1\"]) === \"b 1\");\n    }\n\n    it \"gives the subtopic array value for subtopic type of array\" {\n        logfn(inspect(help([\"b\", \"b2\"])));\n        assert(equal(help([\"b\", \"b2\"]), [\"b 2_1\", \"b 2_2\"]));\n    }\n\n    it \"gives the * property of subtopic type of object\" {\n        logfn(inspect(help([\"b\", \"b3\"])));\n        assert(help([\"b\", \"b3\"]) === \"b 3 *\");\n    }\n\n    it \"gives HELP_NOT_FOUND for nonexistent subtopic of existing topic\" {\n        logfn(inspect(help([\"b\", \"b4\"])));\n        assert(help([\"b\", \"b4\"]) === HELP_NOT_FOUND);\n    }\n\n    it \"replaces {{!}} with the command trigger (string)\" {\n        logfn(inspect(help([\"e\"])));\n\n        assert(help([\"e\"]) === \"@e\");\n    }\n\n    it \"replaces {{!}} with the command trigger (array)\" {\n        assert(equal(help([\"f\"]), [\"@\", \"@\"]));\n    }\n}\n"],"sourceRoot":"/source/"}