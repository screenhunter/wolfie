{"version":3,"sources":["/home/havvy/tennu/tennu/src/lib/client.sjs"],"names":["lodash","require","packagejson","defaultFactoryConfiguration","Socket","defaultClientConfiguration","undefined","Client","config","dependencies","nick","user","Error","client","Object","create","prototype","_config","freeze","defaults","di","_logger","Logger","_socket","IrcSocket","NetSocket","_messageHandler","MessageHandler","_nickname","NicknameTracker","nickname","_outputSocket","IrcOutputSocket","commandHandler","CommandHandler","_subscriber","BiSubscriber","on","privmsg","parse","_plugins","Plugins","addHook","module$2","handlers","note","use","__dirname","plugins","process","cwd","out","events","connected","param","connect","debug","warn","start","disconnect","end","act","apply","arguments","ctcp","join","mode","notice","part","quit","say","userhost","who","whois","raw","rawf","once","off","getModule","moduleExports","getRole","roleExports","initializePlugin","initialize","isPluginInitializable","isInitializable","info","error","crit","alert","emerg","log","level","args","Array","slice","call","module","exports"],"mappings":"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","file":"client.js","sourcesContent":["const lodash = require(\"lodash\");\nconst packagejson = require(\"../package.json\")[\"\"]\n\nmacro delegate {\n    rule { $property:ident $method:ident } => {\n        function () {\n            this . $property . $method . apply (this . $property , arguments);\n            return this;\n        }\n    }\n}\n\nconst defaultFactoryConfiguration = {\n    \"NetSocket\" : require(\"net\").Socket,\n    \"IrcSocket\" : require(\"irc-socket\"),\n    \"IrcOutputSocket\" : require(\"./output-socket.js\"),\n    \"MessageHandler\" : require(\"./message-handler.js\"),\n    \"CommandHandler\" : require(\"./command-handler.js\"),\n    \"Plugins\" : require(\"tennu-plugins\"),\n    \"BiSubscriber\" : require(\"./bisubscriber.js\"),\n    \"Logger\": require(\"./null-logger.js\"),\n    \"NicknameTracker\": require(\"./nickname-tracker.js\")\n};\n\nconst defaultClientConfiguration = {\n    // IrcSocket Config\n    \"server\": undefined,\n    \"port\": 6667,\n    \"ipv6\": undefined,\n    \"localAddress\": undefined,\n    \"secure\": false,\n    \"password\": undefined,\n    \"capab\": false,\n    \"nickname\": \"tennubot\",\n    \"username\": \"tennu\",\n    \"realname\": \"tennu \" + require(\"../package.json\")[\"version\"],\n\n    // Tennu Config\n    \"channels\": [],\n    \"nickserv\": \"nickserv\",\n    \"auth-password\": undefined,\n    \"plugins\": [],\n    \"command-trigger\": \"!\",\n    \"disable-help\": false\n};\n\n/** Fields\n * _config\n * _socket\n * _logger\n * out      (_outputSocket)\n * events   (_subscriber)\n * plugins  (_plugins)\n * nickname (_nickname)\n */\n const Client = function (config, dependencies) {\n    if (config.nick || config.user) {\n        throw new Error(\"Please use \\\"nickname\\\" and \\\"username\\\" instead of \\\"nick\\\" and \\\"user\\\" in your configuration.\");\n    }\n\n    const client = Object.create(Client.prototype);\n\n    // Parse the configuration object. Make it immutable.\n    client._config = config = Object.freeze(lodash.defaults({}, config, defaultClientConfiguration));\n    di = lodash.defaults({}, dependencies || {}, defaultFactoryConfiguration);\n\n    // Create a logger.\n    // Default logger is a bunch of NOOPs.\n    client._logger = new di.Logger();\n\n    // The socket reads and sends messages from/to the IRC server.\n    client._socket = new di.IrcSocket(config, di.NetSocket);\n\n    // Create the listener to the socket.\n    // This listener will parse the raw messages of the socket, and\n    // emits specific events to listen to.\n    client._messageHandler = new di.MessageHandler(client, client._logger, client._socket);\n\n    // Create the object that tracks the nickname of the client.\n    // Because this object is a function, it is expected that\n    // the factory function does not use `this`.\n    client._nickname = di.NicknameTracker(config.nickname, client._messageHandler);\n\n    // The output socket wraps the `raw` method of the client._socket.\n    client._outputSocket = new di.IrcOutputSocket(client._socket, client._messageHandler, client._nickname, client._logger);\n\n    // Create the listener to private messages from the IRCMessageEmitter\n    // The commander will parse these private messages for commands, and\n    // emit those commands, also parsed.\n    const commandHandler = new di.CommandHandler(config, client, client._nickname, client._logger);\n\n    // The subscriber handles event subscriptions to the Client object,\n    // determining whether they should be handled by the IrcMessageEmitter\n    // or the Command Handler.\n    client._subscriber = new di.BiSubscriber(client._messageHandler, commandHandler);\n    client._subscriber.on(\"privmsg\", function (privmsg) { commandHandler.parse(privmsg); });\n\n    // And finally, the module system.\n    client._plugins = new di.Plugins(\"tennu\", client);\n    client._plugins.addHook(\"handlers\", function (module, handlers) {\n        client._subscriber.on(handlers);\n    });\n    client.note(\"Tennu\", \"Loading default plugins\");\n    client._plugins.use([\"server\", \"help\", \"user\", \"channel\", \"startup\"], __dirname);\n    client.note(\"Tennu\", \"Loading your plugins\");\n    client._plugins.use(config.plugins || [], process.cwd());\n\n\n    client.out = client._outputSocket;\n    client.events = client._subscriber;\n    client.plugins = client._plugins;\n    client.nickname = client._nickname;\n\n    client.connected = false;\n\n    client.note(\"Tennu\", \"Client created.\");\n    return client;\n};\n\n// implements ConfigurationStorage\n\nClient.prototype.config = function (param) {\n    return this._config[param];\n};\n\n// implements Runnable ;)\n\nconst connect = function () {\n    this.debug(\"Tennu\", \"Trying to connect.\");\n\n    if (this.connected) {\n        this.warn(\"Tennu\", \"Attempted to start Tennu Client that already is connected.\");\n        return;\n    }\n\n    this._socket.connect();\n    this.connected = true;\n    this.debug(\"Tennu\", \"Connected\");\n    return this;\n}\n\nClient.prototype.connect = connect;\nClient.prototype.start = connect;\n\nconst disconnect = function () {\n    this.debug(\"Tennu\", \"Trying to disconnect.\");\n\n    if (!this.connected) {\n        this.warn(\"Tennu\", \"Attempted to end Tennu Client that already is not connected.\");\n        return this;\n    }\n\n    this._socket.end();\n    this.connected = false;\n    this.debug(\"Tennu\", \"Disconnected\");\n    return this;\n};\n\nClient.prototype.disconnect = disconnect;\nClient.prototype.end = disconnect;\n\n// implements IRC Output Socket\nClient.prototype.act                    = delegate _outputSocket act;\nClient.prototype.ctcp                   = delegate _outputSocket ctcp;\nClient.prototype.join                   = delegate _outputSocket join;\nClient.prototype.mode                   = delegate _outputSocket mode;\nClient.prototype.nick                   = delegate _outputSocket nick;\nClient.prototype.notice                 = delegate _outputSocket notice;\nClient.prototype.part                   = delegate _outputSocket part;\nClient.prototype.quit                   = delegate _outputSocket quit;\nClient.prototype.say                    = delegate _outputSocket say;\nClient.prototype.userhost               = delegate _outputSocket userhost;\nClient.prototype.who                    = delegate _outputSocket who;\nClient.prototype.whois                  = delegate _outputSocket whois;\nClient.prototype.raw                    = delegate _outputSocket raw;\nClient.prototype.rawf                   = delegate _outputSocket rawf;\n\n// implements BiSubscriber\nClient.prototype.on                     = delegate _subscriber on;\nClient.prototype.once                   = delegate _subscriber once;\nClient.prototype.off                    = delegate _subscriber off;\n\n// implements ModuleSystem\nClient.prototype.use                    = delegate _plugins use;\nClient.prototype.getModule              = delegate _plugins moduleExports;\nClient.prototype.getRole                = delegate _plugins roleExports;\nClient.prototype.initializePlugin       = delegate _plugins initialize;\nClient.prototype.isPluginInitializable  = delegate _plugins isInitializable;\nClient.prototype.addHook                = delegate _plugins addHook;\n\n// implements Logger\nClient.prototype.debug                  = delegate _logger debug;\nClient.prototype.info                   = delegate _logger info;\nClient.prototype.note                   = delegate _logger notice;\nClient.prototype.warn                   = delegate _logger warn;\nClient.prototype.error                  = delegate _logger error;\nClient.prototype.crit                   = delegate _logger crit;\nClient.prototype.alert                  = delegate _logger alert;\nClient.prototype.emerg                  = delegate _logger emerg;\n\nClient.prototype.log = function (level) {\n    const args = Array.prototype.slice.call(arguments, 1);\n    this[level].apply(this, args);\n};\n\n// Export the factory.\nmodule.exports = Client;"],"sourceRoot":"/source/"}